USE master 
 
CREATE DATABASE Internet_945
ON  
(NAME = 'internet_945', 
FILENAME = 'C:\Program Files\Microsoft SQL Server\MSSQL15.SQLEXPRESS\MSSQL\DATA\internet_945.mdf', 
SIZE = 1, 
MAXSIZE = 10, 
FILEGROWTH = 1) 
LOG ON  
(NAME = 'internet_945_log', 
FILENAME = 'C:\Program Files\Microsoft SQL Server\MSSQL15.SQLEXPRESS\MSSQL\DATA\internet_945_log.ldf', 
SIZE = 1, 
MAXSIZE = 5, 
FILEGROWTH = 1) 
GO 
--Создание и заполнение таблиц 
USE internet_945
GO 
 
CREATE TABLE Тариф (
[Название Тарифа] nchar(20) not null,
Описание char(100), 
Стоимость money not null check ( Стоимость >= 0 and Стоимость < 1000000)  default 0, 
Скорость nchar(10) not null check (Скорость like '[0-9][0-9][0-9] Мбит/с'), 
[Объем трафика] char(10) check ([Объем трафика] like '[0-9][0-9] ГБ')
) 
GO 

ALTER TABLE Тариф
 	ADD CONSTRAINT PK_Тариф primary key ([Название Тарифа]) 
GO 

CREATE TABLE Сотрудник(
[ФИО Сотрудника] nchar(30) not null check ([ФИО Сотрудника] like '[А-Я]%'),
[Дата рождения] date not null check ([Дата рождения] < '2000-12-30'), 
Стаж int check ( Стаж >= 0 and Стаж < 75), 
Оклад money not null check (оклад > 0) default 11000, 
Специализация nchar(20) not null, 
[ID Сотрудника] int not null identity (1, 1) 
) 
GO 

ALTER TABLE Сотрудник
 	ADD CONSTRAINT PK_Сотрудник primary key ([ID Сотрудника]) 
GO 

CREATE TABLE Клиенты (
[ID Клиента] int not null identity (1, 1),
[ФИО Клиента] nchar(30) not null check ([ФИО Клиента] like '[А-Я]%'), 
[Дата рождения] date not null check([Дата рождения] < '2000-12-30'),
Адрес char(50) not null, 
[Серия и номер паспорта] nchar(11) not null check ([Серия и номер паспорта] like 
'[0-9][0-9][0-9][0-9] [0-9][0-9][0-9][0-9][0-9][0-9]') 
) 
GO 

ALTER TABLE Клиенты
 	ADD CONSTRAINT PK_Клиенты primary key ([ID Клиента]) 
GO 

CREATE TABLE Договор (
[Номер договора] int not null identity (1, 1),
[Название Тарифа] nchar(20) not null,
[Дата и время] datetime not null ,
[ID Сотрудника] int not null,
[ID Клиента] int not null,
unique([Дата и время],[ID Сотрудника],[ID Клиента])
)
GO 

ALTER TABLE Договор
 	ADD CONSTRAINT PK_Договор primary key ([Номер договора]) 
GO 

ALTER TABLE Договор
 	ADD CONSTRAINT FK_Договор_Тариф foreign key ([Название Тарифа]) references тариф([Название Тарифа]) ON DELETE CASCADE 
GO 

ALTER TABLE Договор
 	ADD CONSTRAINT FK_Договор_Сотрудник foreign key ([ID Сотрудника]) references Сотрудник([ID Сотрудника]) ON DELETE CASCADE
GO 

ALTER TABLE Договор
 	ADD CONSTRAINT FK_Договор_Клиенты foreign key ([ID Клиента]) references Клиенты([ID Клиента]) ON DELETE CASCADE
GO

INSERT INTO Тариф VALUES
('МЫ МТС+',			'Мобильная связь для всей семьи',							850,	'100 Мбит/с',	null),
('Тарифище',		'Обмен гигабайтов на кэшбэк',								475,	'100 Мбит/с',	'25 ГБ'),
('Мой Smart ',		'Настрой тариф по-своему',									365,	'180 Мбит/с',	'10 ГБ'),
('Мой Онлайн',		null,														350,	'190 Мбит/с',	'15 ГБ'),
('Технологии ',		'Доступ к видеосервису Wink на 2 месяца за 99 руб/месяц',	549,	'200 Мбит/с',	null),
('Развлечения. PRO','Приоритизация трафика на приложения для работы',			1170,	'200 Мбит/с',	null),
('Максимум'	,		'Защита от нежелательных подписок'	,						350,	'100 Мбит/с',	null),
('Все',				'Гигабайты и минуты сохраняются и накапливаются',			399,	'150 Мбит/с',	'25 ГБ'),
('Премиум',			'VIP-статус',												2000,	'450 Мбит/с',	null),
('Интернет про',	'Скоростной интернет для ваших устройств',					600,	'200 Мбит/с',	'60 ГБ')
GO

DBCC CHECKIDENT('Сотрудник', RESEED, 1) --сброс счетчика 
GO 
INSERT INTO Сотрудник VALUES 
('Дьяченко Андрей Витальевич',	'1997-04-12',	7,	42002,		'Сис-админ'),
('Качанов Никита Васильевич',	'1987-07-15',	2,	32002,		'техник связи'	),
('Краснобаев Дмитрий Сергеевич','1991-11-24',	1,	24005,		'Консультант '),
('Михалин Бегли Владимирович',	'1994-12-13',	3,	24002,		'it-специалист'),
('Поздняков Кирилл Николаевич',	'1981-06-20',	3,	25002,		'Менеджер '),
('Сапаров Никита Алексеевич',	'1982-11-09',	5,	12302,		'it-специалист'),
('Усманов Антон Михайлович',	'1985-12-21',	4,	13002,		'it-специалист'),
('Шашков Руслан Сергеевич',		'1989-01-09',	10,	52002,		'Менеджер'),
('Щавелев Егор Вадимович',		'1986-08-22',	0,	12021,		'Консультант '),
('Чалов Виктор Александрович',	'1984-09-17',	8,	32002,		'Оператор call-центра')
GO

DBCC CHECKIDENT('Клиенты', RESEED, 1) --сброс счетчика 
GO 
INSERT INTO Клиенты VALUES
('Александров Илья Денисович',	'1975-11-23',		'ул. Зои дом 107 кв 676',					'2395 174520'	),
('Савин Константин Дмитрьевич',	'1990-11-10',	 	'ул. Арбатский пер дом 8 кв 44',			'7495 940173'	),
('Ситников Захар Рудольфович',	'1998-02-22',		'ул. Яузские Ворота пл дом 78 кв 287',		'8152 713783'	),
('Волков Арсений Донатович',	'1998-02-22',		'ул. Инженерный сад дом 29 кв 812',			'6458 848304'	),
('Иванков Донат Ростиславович',	'1998-12-02',		'ул. Ленина пр-кт дом 40 кв 774',			'7493 839293'	),
('Куликова Женевьева Лукьевна',	'1996-04-16',		'ул. Тюленина дом 105 кв 225',				'6134 234084'	),
('Мамонтова Анна Филатовна',	'1992-03-30',		 'ул. Колымажный пер дом 196 кв 789',		'6282 834932'	),
('Панова Янита Артёмовна',		'1984-10-12',		'ул. Стремянная дом 77 кв 340',				'6183 283512'	),
('Рожкова Лина Викторовна',		'1991-03-29',		' ул. Ярославский пр-кт дом 98 кв 207',		'6482 865346'	),
('Щукина Инга Романовна',		'2000-02-21',		'ул. Кадашевский 1-й пер дом 189 кв 818',	'1234 561890'	)
GO

DBCC CHECKIDENT('Договор', RESEED, 1) --сброс счетчика 
GO 
INSERT INTO Договор VALUES
(	'МЫ МТС+',			'2015-01-01T23:00:00.000',	1,	1	),
(	'Тарифище'	,		'2016-01-02T23:00:00.000',	1,	2	),
(	'Тарифище',			'2017-01-03T23:00:00.000',	2,	3	),
(	'Технологии',			'2018-01-04T23:00:00.000',	2,	4	),
(	'Мой Smart',			'2019-01-05T23:00:00.000',	3,	5	),
(	'Максимум',			'2015-02-06T23:00:00.000',	3,	6	),
(	'Развлечения. PRO',		'2018-03-07T23:00:00.000',	3,	7	),
(	'МЫ МТС+',			'2017-04-08T23:00:00.000',	3,	8	),
(	'Максимум',			'2016-05-09T23:00:00.000',	4,	9	),
(	'Все'	,			'2015-06-10T23:00:00.000',	4,	10	),
(	'Развлечения. PRO',		'2016-06-11T23:00:00.000',	5,	10	),
(	'Все',				'2017-07-12T23:00:00.000',	5,	2	),
(	'МЫ МТС+',			'2018-08-13T23:00:00.000',	6,	3	),
(	'Премиум',			'2015-09-14T23:00:00.000',	6,	4	),
(	'Премиум',			'2019-08-15T23:00:00.000',	7,	5	),
(	'Премиум',			'2018-07-16T23:00:00.000',	7,	6	),
(	'Интернет про',		'2017-06-17T23:00:00.000',	7,	7	),
(	'Интернет про',		'2016-05-18T23:00:00.000',	8,	8	),
(	'МЫ МТС+',			'2015-08-19T23:00:00.000',	8,	9	),
(	'Интернет про',		'2017-03-20T23:00:00.000',	9,	2	),
(	'Мой Онлайн',			'2018-02-21T23:00:00.000',	9,	2	),
(	'Мой Онлайн',			'2019-01-22T23:00:00.000',	9,	2	)
GO
